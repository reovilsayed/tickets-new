var R=Object.defineProperty;var $=(i,e,t)=>e in i?R(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var E=(i,e,t)=>($(i,typeof e!="symbol"?e+"":e,t),t);import{t as x,r as m,v as O,d as T,_ as M,w as S,x as N,y as D,z,R as H,A as W,m as j}from"./app-a9ae328b.js";import{Q as F,u as q,P as a}from"./index-351dfcfc.js";var y=globalThis&&globalThis.__assign||function(){return y=Object.assign||function(i){for(var e,t=1,o=arguments.length;t<o;t++){e=arguments[t];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=e[s])}return i},y.apply(this,arguments)},I=globalThis&&globalThis.__rest||function(i,e){var t={};for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&e.indexOf(o)<0&&(t[o]=i[o]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(i);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(i,o[s])&&(t[o[s]]=i[o[s]]);return t},Q=x("PulseLoader","0% {transform: scale(1); opacity: 1} 45% {transform: scale(0.1); opacity: 0.7} 80% {transform: scale(1); opacity: 1}","pulse");function G(i){var e=i.loading,t=e===void 0?!0:e,o=i.color,s=o===void 0?"#000000":o,r=i.speedMultiplier,l=r===void 0?1:r,c=i.cssOverride,P=c===void 0?{}:c,g=i.size,u=g===void 0?15:g,p=i.margin,h=p===void 0?2:p,d=I(i,["loading","color","speedMultiplier","cssOverride","size","margin"]),b=y({display:"inherit"},P),v=function(f){return{backgroundColor:s,width:O(u),height:O(u),margin:O(h),borderRadius:"100%",display:"inline-block",animation:"".concat(Q," ").concat(.75/l,"s ").concat(f*.12/l,"s infinite cubic-bezier(0.2, 0.68, 0.18, 1.08)"),animationFillMode:"both"}};return t?m.createElement("span",y({style:b},d),m.createElement("span",{style:v(1)}),m.createElement("span",{style:v(2)}),m.createElement("span",{style:v(3)})):null}var A=function(i){T(e,i);function e(o,s){return i.call(this,o,s)||this}var t=e.prototype;return t.bindMethods=function(){i.prototype.bindMethods.call(this),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)},t.setOptions=function(s,r){i.prototype.setOptions.call(this,M({},s,{behavior:S()}),r)},t.getOptimisticResult=function(s){return s.behavior=S(),i.prototype.getOptimisticResult.call(this,s)},t.fetchNextPage=function(s){var r;return this.fetch({cancelRefetch:(r=s==null?void 0:s.cancelRefetch)!=null?r:!0,throwOnError:s==null?void 0:s.throwOnError,meta:{fetchMore:{direction:"forward",pageParam:s==null?void 0:s.pageParam}}})},t.fetchPreviousPage=function(s){var r;return this.fetch({cancelRefetch:(r=s==null?void 0:s.cancelRefetch)!=null?r:!0,throwOnError:s==null?void 0:s.throwOnError,meta:{fetchMore:{direction:"backward",pageParam:s==null?void 0:s.pageParam}}})},t.createResult=function(s,r){var l,c,P,g,u,p,h=s.state,d=i.prototype.createResult.call(this,s,r);return M({},d,{fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:N(r,(l=h.data)==null?void 0:l.pages),hasPreviousPage:D(r,(c=h.data)==null?void 0:c.pages),isFetchingNextPage:h.isFetching&&((P=h.fetchMeta)==null||(g=P.fetchMore)==null?void 0:g.direction)==="forward",isFetchingPreviousPage:h.isFetching&&((u=h.fetchMeta)==null||(p=u.fetchMore)==null?void 0:p.direction)==="backward"})},e}(F);function Y(i,e,t){var o=z(i,e,t);return q(o,A)}class _ extends m.Component{constructor(e){super(e),this.scrollListener=this.scrollListener.bind(this),this.eventListenerOptions=this.eventListenerOptions.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this)}componentDidMount(){this.pageLoaded=this.props.pageStart,this.options=this.eventListenerOptions(),this.attachScrollListener()}componentDidUpdate(){if(this.props.isReverse&&this.loadMore){const e=this.getParentElement(this.scrollComponent);e.scrollTop=e.scrollHeight-this.beforeScrollHeight+this.beforeScrollTop,this.loadMore=!1}this.attachScrollListener()}componentWillUnmount(){this.detachScrollListener(),this.detachMousewheelListener()}isPassiveSupported(){let e=!1;const t={get passive(){e=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch{}return e}eventListenerOptions(){let e=this.props.useCapture;return this.isPassiveSupported()?e={useCapture:this.props.useCapture,passive:!0}:e={passive:!1},e}setDefaultLoader(e){this.defaultLoader=e}detachMousewheelListener(){let e=window;this.props.useWindow===!1&&(e=this.scrollComponent.parentNode),e.removeEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture)}detachScrollListener(){let e=window;this.props.useWindow===!1&&(e=this.getParentElement(this.scrollComponent)),e.removeEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),e.removeEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture)}getParentElement(e){const t=this.props.getScrollParent&&this.props.getScrollParent();return t??(e&&e.parentNode)}filterProps(e){return e}attachScrollListener(){const e=this.getParentElement(this.scrollComponent);if(!this.props.hasMore||!e)return;let t=window;this.props.useWindow===!1&&(t=e),t.addEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture),t.addEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),t.addEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture),this.props.initialLoad&&this.scrollListener()}mousewheelListener(e){e.deltaY===1&&!this.isPassiveSupported()&&e.preventDefault()}scrollListener(){const e=this.scrollComponent,t=window,o=this.getParentElement(e);let s;if(this.props.useWindow){const r=document.documentElement||document.body.parentNode||document.body,l=t.pageYOffset!==void 0?t.pageYOffset:r.scrollTop;this.props.isReverse?s=l:s=this.calculateOffset(e,l)}else this.props.isReverse?s=o.scrollTop:s=e.scrollHeight-o.scrollTop-o.clientHeight;s<Number(this.props.threshold)&&e&&e.offsetParent!==null&&(this.detachScrollListener(),this.beforeScrollHeight=o.scrollHeight,this.beforeScrollTop=o.scrollTop,typeof this.props.loadMore=="function"&&(this.props.loadMore(this.pageLoaded+=1),this.loadMore=!0))}calculateOffset(e,t){return e?this.calculateTopPosition(e)+(e.offsetHeight-t-window.innerHeight):0}calculateTopPosition(e){return e?e.offsetTop+this.calculateTopPosition(e.offsetParent):0}render(){const e=this.filterProps(this.props),{children:t,element:o,hasMore:s,initialLoad:r,isReverse:l,loader:c,loadMore:P,pageStart:g,ref:u,threshold:p,useCapture:h,useWindow:d,getScrollParent:b,...v}=e;v.ref=w=>{this.scrollComponent=w,u&&u(w)};const f=[t];return s&&(c?l?f.unshift(c):f.push(c):this.defaultLoader&&(l?f.unshift(this.defaultLoader):f.push(this.defaultLoader))),H.createElement(o,v,f)}}E(_,"propTypes",{children:a.node.isRequired,element:a.node,hasMore:a.bool,initialLoad:a.bool,isReverse:a.bool,loader:a.node,loadMore:a.func.isRequired,pageStart:a.number,ref:a.func,getScrollParent:a.func,threshold:a.number,useCapture:a.bool,useWindow:a.bool}),E(_,"defaultProps",{element:"div",hasMore:!1,initialLoad:!0,pageStart:0,ref:null,threshold:250,useWindow:!0,isReverse:!1,useCapture:!1,loader:null,getScrollParent:null});const J=(i,e,t={},o={})=>{const{prefetch:s,pageSize:r=10,...l}=o,c=W(),P=async({pageParam:n=1})=>(console.log(`${e}?page=${n}&per_page=5&query=${(t==null?void 0:t.query)??""}&event_id=${(t==null?void 0:t.event_id)??""}&event_date=${(t==null?void 0:t.eventDate)??""}`),(await j.get(`${e}?page=${n}&per_page=5&query=${(t==null?void 0:t.query)??""}&event_id=${(t==null?void 0:t.event_id)??""}&event_date=${(t==null?void 0:t.eventDate)??""}`,{headers:{"Content-Type":"application/json"}})).data),{data:g,isLoading:u,isError:p,isSuccess:h,error:d,hasNextPage:b,fetchNextPage:v,isFetching:f}=Y(i,P,{...l,getNextPageParam:n=>{const L=n==null?void 0:n.current_page,C=n==null?void 0:n.last_page;return L<C?L+1:null}});return m.useEffect(()=>{var n;((n=d==null?void 0:d.response)==null?void 0:n.status)===401&&localStorage.setItem("authData",null)},[p,d]),{data:g,isLoading:u,isError:p,isSuccess:h,hasNextPage:b,isFetching:f,fetchNextPage:v,refetch:n=>{c.invalidateQueries(n||i)},setData:n=>{c.setQueryData(i,L=>n(L))}}};export{_ as I,G as P,J as u};
