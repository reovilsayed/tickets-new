"use strict";FLIPBOOK.BookScroll=class extends FLIPBOOK.Book{constructor(i,t,e,s){super(e,s),this.singlePage&&(this.view=1),this.view=1,this.rightIndex=0,this.pageGap=16,this.slides=[],this.pagesArr=[],this.leftPage=0,this.rightPage=0,this.rotation=0,this.verticalScroller=i,this.verticalScroller.style.width=this.pageWidth+"px",s.pageGap=this.pageGap;for(let i=0;i<s.numPages;i++){const h=new FLIPBOOK.PageScroll(this,t,e,s,i);this.verticalScroller.appendChild(h.wrapper),h.initObserver(),this.pagesArr.push(h)}this.prevPageEnabled=!1,this.setRightIndex(0),this.currentSlide=0,this.flipping=!1,this.wrapper=t,this.verticalScroller.classList.remove("book"),this.verticalScroller.style.paddingTop=this.pageGap/2+"px",this.verticalScroller.style.paddingBottom=this.pageGap/2+"px",this.iscroll=new IScroll(this.wrapper,{freeScroll:!0,mouseWheel:!0,scrollbars:!0,interactiveScrollbars:!0,zoom:!0,scrollX:!0,scrollY:!0,keepInCenterV:!0,keepInCenterH:!0,preventDefault:!1,zoomMin:.01,zoomMax:10,mouseWheelTimeout:100,disablePointer:!1,disableTouch:!1,disableMouse:!1,momentum:!0}),this.main.on("disableIScroll",(()=>{this.disableIscroll()})),this.main.on("enableIScroll",(()=>{this.enableIscroll()}));var h=this;this.iscroll.on("scrollStart",(function(){h.scrolling=!0})),this.iscroll.on("zoomEnd",(function(){h.updateRightIndex()})),this.iscroll.on("scrollEnd",(function(){h.updateRightIndex(),h.scrolling=!1,h.pagesArr.forEach((i=>{i.visibility>0&&i.load()}))})),this.zoomDisabled=!1,e.on("pageLoaded",(function(i){}))}enableIscroll(){this.iscrollDisabled&&(this.iscroll.enable(),this.iscrollDisabled=!1)}disableIscroll(){this.iscrollDisabled||(this.iscroll.disable(),this.iscroll.initiated=!1,this.iscrollDisabled=!0)}goToPage(i,t){if(!this.enabled)return;if(i>this.options.pages.length&&(i=this.options.pages.length),(this.singlePage||i%2!=0)&&i--,i==this.rightIndex)return;this.enableIscroll(),(isNaN(i)||i<0)&&(i=0);let e=-i*(this.pageHeight+this.pageGap)*this.iscroll.scale,s=-(this.iscroll.scrollerHeight-this.main.wrapperH);e=Math.max(e,s);var h=t?0:600;this.iscroll.scrollTo(0,e,h),this.setRightIndex(i),this.main.turnPageComplete()}setRightIndex(i){i!=this.rightIndex&&(this.rightIndex=i,this.main.turnPageComplete())}nextPage(i){this.goToPage(this.rightIndex+2,i)}prevPage(i){this.goToPage(this.rightIndex,i)}enablePrev(i){this.prevEnabled=i}enableNext(i){this.nextEnabled=i}isFocusedRight(){return this.rightIndex%2==0}isFocusedLeft(){return this.rightIndex%2==1}updateVisiblePages(){}disable(){this.enabled=!1}enable(){this.enabled=!0,this.onResize()}resize(){}onResize(){var i=this.main.wrapperW,t=this.main.wrapperH;0==i||0==t||this.w===i&&this.h===t||(this.w=i,this.h=t,this.zoom&&(this.iscroll.refresh(),this.fit(),this.iscroll.scrollTo(0,this.iscroll.y,0)),this.updateRightIndex())}updateRightIndex(){let i=0,t=0;this.pagesArr.forEach((e=>{e.visibility>i&&(i=e.visibility,t=e.index)})),this.setRightIndex(t)}zoomIn(i,t,e){e&&"mousewheel"===e.type||this.zoomTo(i)}fitToHeight(){this.iscroll.zoom(this.zoom*this.main.wrapperH/this.pageHeight,0,0,0)}fitToWidth(){this.iscroll.zoom(this.zoom*this.main.wrapperW/this.pageWidth,0,0,0)}fit(){this.options.fitToWidth||this.main.wrapperW/this.main.wrapperH<this.pageWidth/this.pageHeight?this.fitToWidth():this.fitToHeight()}zoomTo(i,t,e,s){if(this.enabled&&!this.zoomDisabled){var h=this.main,l=h.wrapperW,o=h.wrapperH;0!=l&&0!=o&&(this.zoom=i,this.fit(),i>1&&this.disableFlip(),this.onZoom(i))}}zoomOut(i){this.zoomTo(i)}onZoom(i){this.options.main.onZoom(i)}enable(){this.enabled=!0}disable(){this.enabled=!1}onSwipe(i,t,e){}disableFlip(){}enableFlip(){}enablePan(){}disablePan(){}canFlipNext(){return this.rightIndex+1<this.options.numPages}},FLIPBOOK.PageScroll=class{constructor(i,t,e,s,h,l,o){this.rotation=0,this.bookWrapper=t,this.index=h,this.options=s,this.texture=l,this.html=o,this.index=h,this.wrapper=document.createElement("div"),this.wrapper.className="flipbook-scroll-page",this.wrapper.style.marginBottom=this.options.pageGap+"px",this.main=e,this.book=i,this.inner=document.createElement("div"),this.inner.className="flipbook-scroll-page-inner",this.wrapper.appendChild(this.inner),this.bg=document.createElement("div"),this.bg.className="flipbook-scroll-page-bg",this.inner.appendChild(this.bg),this.html=document.createElement("div"),this.html.className="flipbook-page3-html",this.wrapper.appendChild(this.html),this.html.style.width=1e3*this.options.pageWidth/this.options.pageHeight+"px",this.html.style.transform="scale("+this.options.pageHeight/1e3+") translateZ(0)",this.options.doublePage&&(this.index%2==0&&this.index>0?this.html.style.left="-100%":this.html.style.left="0"),this.preloader=document.createElement("img"),s.pagePreloader?(this.preloader.src=s.pagePreloader,this.preloader.className="flipbook-page-preloader-image"):(this.preloader.src=s.assets.spinner,this.preloader.className="flipbook-page-preloader"),this.inner.appendChild(this.preloader),this.setSize(this.pw,this.ph)}initObserver(){new IntersectionObserver((i=>{const t=i[0].intersectionRatio;t>0?this.show(t):this.hide()}),{root:this.bookWrapper,threshold:[0,.1,.5]}).observe(this.wrapper)}show(i){this.visibility=i,this.book.scrolling||this.load(),this.isVisible||(this.bg.style.display="block",this.html.style.display="block",this.isVisible=!0)}load(i,t){if(!this.loaded&&0!=this.visibility){this.loaded=!0;var e=this.options.pageTextureSize;if(this.size>=e)return t||this.loadHTML(),void(i&&i.call(this));this.size=e;var s=this,h=this.options.rightToLeft?this.options.numPages-this.index-1:this.index;this.options.main.loadPage(h,e,(function(l){if((l=l||{})&&l.image){var o=l.image[e]||l.image;o.classList.add("page-scroll-img"),s.index%2!=0||"left"!=s.options.pages[h].side&&"right"!=s.options.pages[h].side||(o.clone||(o.clone=new Image,o.clone.src=o.src),o=o.clone),s.bg.appendChild(o),s.options.doublePage&&s.index>0&&s.index%2==0&&(o.style.left="-100%"),s.options.doublePage?0==s.index||s.index==s.options.pages.length-1&&s.options.backCover?o.style.width="100%":o.style.width="200%":o.style.width="100%",s.inner.removeChild(s.preloader)}t||s.loadHTML(),i&&i.call(s)}))}}hide(){this.visibility=0,this.isVisible&&(this.bg.style.display="none",this.html.style.display="none",this.isVisible=!1,this.pauseHTML())}pauseHTML(){this.html.querySelectorAll("video, audio").forEach((function(i){i.pause()}))}loadHTML(){var i=this,t=this.options.rightToLeft?this.options.numPages-this.index-1:this.index;this.htmlContent?this.updateHtmlContent():this.options.main.loadPageHTML(t,(function(t){i.htmlContent=t,i.updateHtmlContent()}))}setSize(){this.wrapper.style.width=this.options.pageWidth+"px",this.wrapper.style.height=this.options.pageHeight+"px",this.updateHtmlContent()}updateHtmlContent(){var i=this.htmlContent;i&&!this.htmlContentVisible&&(i.jquery&&(i=i[0]),this.htmlContentVisible=!0,this.html.replaceChildren(),this.html.appendChild(i),this.startHTML(),this.main.trigger("showpagehtml",{page:this})),this.startHTML()}startHTML(){this.book.startPageItems(this.wrapper)}};