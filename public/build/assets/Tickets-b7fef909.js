import{u as f,b as j,j as s,B as N,q as b,a as p,r as u,H as y}from"./app-a9ae328b.js";import{u as w,I,P}from"./useInfiniteFetch-307040fa.js";import{f as C,v as _,a as E}from"./utils-8b9f25e8.js";import"./index-351dfcfc.js";const T=({ticket:e})=>{var l,d,r,i,a;const n=f(),h=c=>{c.stopPropagation(),n(b(e))},{addItem:o,removeItem:x,inCart:g}=j(),m=g(e==null?void 0:e.id);return s.jsx("div",{className:`ticket-item-container col-lg-2 col-md-3 col-sm-3 col-6 my-hover-effect g-3 ${m?"active":""}`,onClick:()=>{if(!((e==null?void 0:e.quantity)>0)){N("Cannot add to cart as no tickets are available!");return}o({...e,isTicket:!0})},children:s.jsxs("div",{className:"ticket-item-card",children:[m?s.jsx("button",{className:"delete-btn",onClick:()=>{x(e.id)},children:s.jsx("i",{className:"fa fa-times"})}):"",s.jsxs("div",{className:"custom-card",children:[s.jsxs("span",{className:"ticket-item-badge",children:[C(e!=null&&e.sale_price?e==null?void 0:e.sale_price:e==null?void 0:e.price)," â‚¬"]}),s.jsxs("div",{className:"card-header position-relative",children:[s.jsx("img",{className:"ticket-item-img",src:_(e==null?void 0:e.event_thumbnail)}),((l=e==null?void 0:e.event)==null?void 0:l.name)&&s.jsx("span",{className:"ticket-item-unit",children:((d=e==null?void 0:e.event)==null?void 0:d.name.length)>15?`${e.event.name.substring(0,15)}...`:(r=e==null?void 0:e.event)==null?void 0:r.name})]}),s.jsxs("div",{className:"card-body ticket-item-body",children:[s.jsx("p",{title:e.name,className:"ticket-item-name",children:(e==null?void 0:e.name.length)>15?`${e.name.substring(0,15)}...`:e.name}),s.jsx("small",{className:"ticket-item-generic",children:((a=(i=e==null?void 0:e.event)==null?void 0:i.organizer)==null?void 0:a.length)>25?`${e.event.organizer.substring(0,25)}...`:e==null?void 0:e.event.organizer}),(e==null?void 0:e.start_date)&&(e==null?void 0:e.end_date)&&s.jsxs("small",{children:["(",E(e.start_date,e.end_date),")"]}),s.jsx("button",{onClick:h,className:"btn btn-primary btn-sm position-absolute rounded-circle ticket-item-info-btn",children:s.jsx("i",{className:"fa fa-info"})})]})]})]})})};function q(){var i;const e=p(a=>a.searchQuery.query),n=p(a=>a.filter.event),h=p(a=>a.filter.date),{data:o,isError:x,isLoading:g,isFetching:m,hasNextPage:l,fetchNextPage:d}=w(["tickets",e,n,h],"https://events.essenciacompany.com/api/tickets",{query:e,event_id:n==null?void 0:n.id,eventDate:h}),r=u.useCallback(()=>{const a=document.documentElement.scrollTop;a<500&&a===0&&l&&!m&&d()},[d,l,m]);return u.useEffect(()=>(window.addEventListener("scroll",r),()=>{window.removeEventListener("scroll",r)}),[r]),s.jsx("div",{className:"overflow-y-scroll overflow-x-none pt-3",children:n?g?s.jsx("div",{style:{width:"100%",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:s.jsx(y,{color:"#36d7b7"})}):s.jsx(I,{loadMore:d,hasMore:l,loader:s.jsx("div",{style:{textAlign:"center",paddingTop:"25px"},children:s.jsx(P,{color:"#36d7b7"})}),useWindow:!1,style:{overflowY:"scroll",overflowX:"hidden",maxHeight:"90vh",padding:"20px 10px"},onScroll:r,children:s.jsx("div",{className:"row g-3",children:x?s.jsx("div",{style:{textAlign:"center",color:"red"},children:"Something went wrong"}):(i=o==null?void 0:o.pages)!=null&&i.length?o.pages.map((a,c)=>s.jsx(u.Fragment,{children:a.data.map((v,t)=>s.jsx(T,{ticket:v},t))},c)):s.jsx("div",{style:{textAlign:"center"},children:"No matching products found."})})}):s.jsx("h4",{className:"text-info text-center",children:"Please Select An Event"})})}export{q as default};
